{% extends 'seller/seller_index.html' %}

{% block content %}
<div class="container mt-4">
  <div class="card">
    <div class="card-header">
      <h4>Order Details – #{{ order.id }}</h4>
    </div>

    <div class="card-body">
      <div class="row">

        <!-- LEFT -->
        <div class="col-md-6">
          <h5>Order Info</h5>
          <p><strong>Date:</strong> {{ order.order_date|date:"M d, Y H:i" }}</p>

          <h5 class="mt-4">Products</h5>

          {% for item in order.items.all %}
            {% if item.product.seller.id == request.session.id %}
            <div class="d-flex mb-3">
              {% if item.product.image %}
              <img src="{{ item.product.image.url }}" width="80" class="me-3 rounded">
              {% endif %}
              <div>
                <h6>{{ item.product.name }}</h6>
                <p class="mb-1">Qty: {{ item.quantity }}</p>
                <p class="mb-1">Price: ₹{{ item.price }}</p>
              </div>
            </div>
            {% endif %}
          {% endfor %}

          <p class="mt-2"><strong>Total:</strong> ₹{{ order.total_amount }}</p>
        </div>

        <!-- RIGHT -->
        <div class="col-md-6">
          <h5>Payment Info</h5>

          {% if payment %}
            <p><strong>Method:</strong> {{ payment.get_payment_method_display }}</p>
            <p><strong>Amount:</strong> ₹{{ payment.amount }}</p>
            <p><strong>Date:</strong> {{ payment.payment_date|date:"M d, Y H:i" }}</p>

            <p>
              <strong>Status:</strong>
              {% if payment.is_successful %}
                <span class="badge bg-success">Successful</span>
              {% else %}
                <span class="badge bg-danger">Failed</span>
              {% endif %}
            </p>

            {% if payment.payment_method == 'upi' %}
              <p><strong>UPI:</strong> {{ payment.upi_id }}</p>
            {% elif payment.payment_method == 'card' %}
              <p><strong>Card:</strong> **** {{ payment.card_number }}</p>
            {% endif %}

            <p><strong>Transaction ID:</strong> {{ payment.transaction_id }}</p>

          {% else %}
            <div class="alert alert-warning">
              No payment made yet.
            </div>
          {% endif %}

          <h5 class="mt-4">Customer Info</h5>
          <p><strong>Name:</strong> {{ order.user.name }}</p>
          <p><strong>Email:</strong> {{ order.user.email }}</p>
          <p><strong>Phone:</strong> {{ order.user.phone_number }}</p>
        </div>

      </div>
    </div>

    <div class="card-footer">
      <a href="{% url 'seller_orders' %}" class="btn btn-secondary">
        Back to Orders
      </a>
    </div>
  </div>
</div>
{% endblock %}
